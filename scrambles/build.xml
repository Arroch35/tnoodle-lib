<project name="tnoodlescrambles" default="compile" basedir=".">
	<description>
		TODO
	</description>

	<property name="src" location="src" />
	<property name="bin" location="bin" />
	<property name="dist" location="dist" />

	<property name="proj" location="." />
	<property name="name" value="${ant.project.name}" />
	<propertyset id="tnoodle">
		<propertyref name="proj" />
		<propertyref name="name" />
	</propertyset>

	<property name="plugin-list" location="${bin}/scramblers/plugins.txt" />

	<!--
		 TODO - maybe make a neat command line utility for generating scrambles?
	<property name="main" value="" />
	-->

	<target name="compile">
		<ant antfile="../build.xml" target="compile" inheritAll="false">
			<propertyset refid="tnoodle" />
		</ant>

		<!-- indexing plugins (they were copied to ${bin} when we compiled them) -->
		<delete file="${plugin-list}" />
		<pathconvert property="plugin-files" pathsep="${line.separator}">
		    <path>
				<fileset dir="${bin}/scramblers" />
		    </path>
			<chainedmapper>
				<flattenmapper />
		    	<globmapper from="*.class" to="*" />
			</chainedmapper>
		</pathconvert>
		<echo>Detected the following plugins:</echo>
		<echo>${plugin-files}</echo>
		
		<echo file="${plugin-list}">${plugin-files}</echo>
		
		<!-- copying plugin icons -->
		<copy todir="${bin}/scramblers">
			<fileset dir="${src}/scramblers" includes="*.png" />
		</copy>
	</target>

	<target name="dist"> 
		<ant antfile="../build.xml" target="dist" inheritAll="false">
			<propertyset refid="tnoodle" />
		</ant>
	</target>
	
	<target name="clean">
		<ant antfile="../build.xml" target="clean" inheritAll="false">
			<propertyset refid="tnoodle" />
		</ant>
	</target>
</project>
